{% extends "admin/base_site.html" %}

{% block title %}{{ title }} - Admin{% endblock %}

{% block content %}
<div id="content-main">
    <h1>{{ title }}</h1>
    
    <div class="module">
        <h2>File Upload</h2>
        <form method="post" enctype="multipart/form-data" style="padding: 20px;">
            {% csrf_token %}
            
            <div style="margin-bottom: 20px;">
                <label for="file" style="display: block; font-weight: bold; margin-bottom: 8px;">Select File (CSV or Excel):</label>
                <input type="file" id="file" name="file" accept=".csv,.xlsx,.xls" required style="display: block; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"/>
                <p style="margin-top: 10px; color: #666; font-size: 12px;">Accepted formats: Excel (.xlsx, .xls) or CSV files</p>
            </div>
            
            {% if messages %}
            <div style="padding: 15px; margin-bottom: 20px; background-color: #ffeaea; border: 1px solid #ff0000; border-radius: 4px;">
                {% for message in messages %}
                    <p style="margin: 5px 0; color: #333;">{{ message }}</p>
                {% endfor %}
            </div>
            {% endif %}
            
            <div style="padding-top: 15px; border-top: 1px solid #ddd; text-align: center;">
                <button type="submit" style="padding: 8px 20px; background-color: #417690; color: white; border: 1px solid #417690; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                    Upload and Import
                </button>
                <a href="../" style="padding: 8px 20px; background-color: #999; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">
                    Cancel
                </a>
            </div>
        </form>
    </div>
    
    {% if title == 'Bulk Import Students' %}
    <div style="margin-top: 30px; padding: 20px; background-color: #f5f5f5; border: 1px solid #ddd; border-radius: 4px;">
        <h3>Required File Format</h3>
        <p>Your Excel file must have these exact column headers (in this order):</p>
        <ol style="margin-left: 20px; color: #333;">
            <li><strong>Student Name</strong> - Full name of student</li>
            <li><strong>Hall Ticket No</strong> - Unique hall ticket number (e.g., 23BEC1001)</li>
            <li><strong>Room No</strong> - Room number (e.g., A-101)</li>
            <li><strong>Gender</strong> - M or F</li>
            <li><strong>Email</strong> - Student's email address</li>
            <li><strong>Mobile</strong> - 10-digit mobile number</li>
            <li><strong>Parent Name</strong> - Parent's name</li>
            <li><strong>Parent Mobile</strong> - 10-digit parent mobile number</li>
            <li><strong>Approved</strong> - (Optional) Yes/No, true/false, or 1/0. Defaults to Yes</li>
        </ol>
        
        <h4 style="margin-top: 25px; color: #333; font-size: 14px; font-weight: bold;">Example Excel Format:</h4>
        <table style="width: 100%; margin-top: 15px; border-collapse: collapse; font-size: 12px; background-color: white;">
            <tr style="background-color: #e8e8e8;">
                <th style="padding: 10px; border: 1px solid #ddd;">Student Name</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Hall Ticket No</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Room No</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Gender</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Email</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Mobile</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Parent Name</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Parent Mobile</th>
                <th style="padding: 10px; border: 1px solid #ddd;">Approved</th>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;">John Smith</td>
                <td style="padding: 10px; border: 1px solid #ddd;">23BEC1001</td>
                <td style="padding: 10px; border: 1px solid #ddd;">A-101</td>
                <td style="padding: 10px; border: 1px solid #ddd;">M</td>
                <td style="padding: 10px; border: 1px solid #ddd;">john@example.com</td>
                <td style="padding: 10px; border: 1px solid #ddd;">9876543210</td>
                <td style="padding: 10px; border: 1px solid #ddd;">Mary Smith</td>
                <td style="padding: 10px; border: 1px solid #ddd;">9876543211</td>
                <td style="padding: 10px; border: 1px solid #ddd;">Yes</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;">Sarah Johnson</td>
                <td style="padding: 10px; border: 1px solid #ddd;">23BEC1002</td>
                <td style="padding: 10px; border: 1px solid #ddd;">A-102</td>
                <td style="padding: 10px; border: 1px solid #ddd;">F</td>
                <td style="padding: 10px; border: 1px solid #ddd;">sarah@example.com</td>
                <td style="padding: 10px; border: 1px solid #ddd;">9876543212</td>
                <td style="padding: 10px; border: 1px solid #ddd;">Patricia Johnson</td>
                <td style="padding: 10px; border: 1px solid #ddd;">9876543213</td>
                <td style="padding: 10px; border: 1px solid #ddd;">Yes</td>
            </tr>
        </table>
    </div>
    {% endif %}
    
    {% if title == 'Bulk Import Gatepasses' %}
    <div style="margin-top: 30px; padding: 20px; background-color: #f5f5f5; border: 1px solid #ddd; border-radius: 4px;">
        <h3>Required File Format</h3>
        <p>Your Excel or CSV file must contain the following columns (in any order):</p>
        <table style="width: 100%; margin-top: 15px; border-collapse: collapse; background-color: white;">
            <tr style="background-color: #e8e8e8;">
                <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Column Name</th>
                <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Description</th>
                <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Example</th>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>hall_ticket_no</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Student's hall ticket (must exist in system)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">23BEC1234</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>outing_date</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Date of outing (YYYY-MM-DD)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">2026-01-20</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>outing_time</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Time of outing (HH:MM:SS)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">09:00:00</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>expected_return_date</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Expected return date (YYYY-MM-DD)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">2026-01-20</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>expected_return_time</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Expected return time (HH:MM:SS)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">18:00:00</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>purpose</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Purpose of outing</td>
                <td style="padding: 10px; border: 1px solid #ddd;">Visit home</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>status</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Current status (lowercase)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">pending, warden_approved, security_approved, etc.</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>parent_verification</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">true/false (optional)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">true</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>actual_return_date</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Actual return date (optional, YYYY-MM-DD)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">2026-01-20</td>
            </tr>
            <tr style="background-color: #fafafa;">
                <td style="padding: 10px; border: 1px solid #ddd;"><strong>actual_return_time</strong></td>
                <td style="padding: 10px; border: 1px solid #ddd;">Actual return time (optional, HH:MM:SS)</td>
                <td style="padding: 10px; border: 1px solid #ddd;">17:30:00</td>
            </tr>
        </table>
        
        <h3 style="margin-top: 30px;">Valid Status Values</h3>
        <ul style="margin-left: 20px; color: #666;">
            <li>pending</li>
            <li>warden_approved</li>
            <li>warden_rejected</li>
            <li>security_approved</li>
            <li>returned</li>
            <li>completed</li>
        </ul>
    </div>
    {% endif %}
</div>

<style>
    #content-main {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
    }
    
    h1 {
        color: #333;
        margin-bottom: 20px;
        font-size: 24px;
    }
    
    h3 {
        color: #333;
        margin-top: 20px;
        margin-bottom: 10px;
        font-size: 14px;
        font-weight: bold;
    }
    
    h4 {
        color: #555;
        margin-bottom: 10px;
    }
    
    .module {
        border: 1px solid #ddd;
        border-radius: 4px;
        background-color: white;
        margin-bottom: 20px;
    }
    
    .module h2 {
        padding: 10px 15px;
        background-color: #417690;
        color: white;
        margin: 0;
        border-bottom: 1px solid #ddd;
        font-size: 16px;
    }
    
    p {
        color: #666;
        line-height: 1.6;
    }
</style>
{% endblock %}
